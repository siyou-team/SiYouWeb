(function(_x10096){'use strict';var app=getApp(),$=require(_x10096[0]),notice=require(_x10096[1]);Page({data:{AddressInfo:{},cartinfo:{},isVirtual:0,ud_id:0,spinfo:_x10096[2],remark:_x10096[2],remarkLength:0,formId:_x10096[2],submitinfo:{},user_voucher_ids:[],order_message:{},isSubmit:!1,order_id:_x10096[2],integral:_x10096[2],discount:0,disbursements:_x10096[2],IsUseCoupon:1,addressFlag:!0,selfpickFlag:!1,chainFlag:!1,date:_x10096[2],pid:_x10096[2],ud_name:_x10096[2],phone:_x10096[2],stdate:_x10096[2],eddate:_x10096[2],time:_x10096[2],addInfo:_x10096[2],addInfo1:_x10096[2],shipMethod:0,physicalStoreId:_x10096[2],item_ids:[],activity_id:0,sponsorId:0,balance:0,realMoney:0,isBalance:!0,eCardCash:0,extraCash:0,isMembership:!0,isECashCard:!0,isCoupon:!0,isTmplMsg:!0,can_delivery:!1,ifcart:!1,cart_id:_x10096[2],ChainInfo:{}},onLoad:function(e){this[_x10096[3]]({activity_id:e[_x10096[4]],urlArgs:e}),e[_x10096[5]]&&this[_x10096[3]]({ifcart:e[_x10096[5]]}),e[_x10096[6]]&&this[_x10096[3]]({cart_id:e[_x10096[6]]});var t=this;notice[_x10096[7]](_x10096[8],t[_x10096[8]],t),notice[_x10096[7]](_x10096[9],t[_x10096[9]],t),notice[_x10096[7]](_x10096[10],t[_x10096[10]],t),this[_x10096[11]]();},onUnload:function(){var e=this;notice[_x10096[12]](_x10096[8],e),notice[_x10096[12]](_x10096[9],e),notice[_x10096[12]](_x10096[10],e);},inputud_name:function(e){this[_x10096[3]]({ud_name:e[_x10096[14]][_x10096[13]]});},inputphone:function(e){this[_x10096[3]]({phone:e[_x10096[14]][_x10096[13]]}),/^1[34578]\d{9}$/[_x10096[15]](e[_x10096[14]][_x10096[13]])?this[_x10096[3]]({isre:!0}):this[_x10096[3]]({isre:!1});},RefreshOrder:function(e){this[_x10096[3]]({ud_id:e[_x10096[16]],spinfo:e[_x10096[17]],addInfo1:this[_x10096[19]][_x10096[18]]}),this[_x10096[20]](_x10096[16],e[_x10096[16]]),this[_x10096[11]]();},RefreshOrderChain:function(e){this[_x10096[3]]({ChainInfo:e[_x10096[21]],chain_id:e[_x10096[21]][_x10096[22]]}),this[_x10096[11]]();},RefreshCoupon:function(e){for(var t=this,a=$[_x10096[23]](e[_x10096[24]]),i=this[_x10096[19]][_x10096[25]],s=0;s<a[_x10096[26]];s++){a[s][_x10096[27]];a[s][_x10096[28]]==e[_x10096[28]]?$[_x10096[29]](i,e[_x10096[28]])||i[_x10096[30]](e[_x10096[28]]):$[_x10096[31]](i,a[s][_x10096[28]]);}this[_x10096[3]]({user_voucher_ids:i});for(var r=t[_x10096[19]][_x10096[32]],d=r[_x10096[33]],o=0;o<r[_x10096[34]][_x10096[26]];o++)for(var n=0;n<r[_x10096[34]][o][_x10096[35]][_x10096[26]];n++){var u=r[_x10096[34]][o][_x10096[35]][n],c=u[_x10096[28]];if(r[_x10096[34]][o][_x10096[36]]=[],r[_x10096[34]][o][_x10096[28]]=0,$[_x10096[29]](i,c)){r[_x10096[34]][o][_x10096[36]]=u,r[_x10096[34]][o][_x10096[28]]=c,d-=u[_x10096[37]],r[_x10096[34]][o][_x10096[38]]=r[_x10096[34]][o][_x10096[39]]-u[_x10096[37]];break;}}t[_x10096[3]]({submitinfo:r,order_amount:d});},getCartList:function(){var e=this,t=this[_x10096[19]][_x10096[40]];$[_x10096[41]]({url:app[_x10096[45]][_x10096[44]][_x10096[43]][_x10096[42]],data:t,success:function(t,a,i,s){if(200==a){var r=new Date(),d=new Date(r);d[_x10096[46]](r[_x10096[47]]()+parseInt(31104000));var o=r[_x10096[48]]()+_x10096[49]+(r[_x10096[50]]()+1)+_x10096[49]+r[_x10096[47]](),n=d[_x10096[48]]()+_x10096[49]+(d[_x10096[50]]()+1)+_x10096[49]+d[_x10096[47]](),u=0;if($[_x10096[51]](t[_x10096[52]])||(u=t[_x10096[52]][_x10096[16]]),t[_x10096[53]]){var c=t[_x10096[34]][0][_x10096[34]][0];e[_x10096[3]]({item_ids:[c[_x10096[54]]]}),e[_x10096[55]](c[_x10096[27]]),e[_x10096[3]]({isVirtual:t[_x10096[53]],product_service_date_flag:c[_x10096[56]],product_service_contactor_flag:c[_x10096[57]],product_valid_type:c[_x10096[58]],ud_id:u,store_id:c[_x10096[27]],chainFlag:1002!=c[_x10096[58]],addressFlag:1002==c[_x10096[58]],submitinfo:t,eddate:n,stdate:o});}else e[_x10096[3]]({isVirtual:t[_x10096[53]],product_service_date_flag:1,product_service_contactor_flag:1,product_valid_type:1001,ud_id:u,submitinfo:t,eddate:n,stdate:o});e[_x10096[3]]({order_amount:t[_x10096[33]]}),e[_x10096[19]][_x10096[28]]>0&&e[_x10096[59]](e[_x10096[19]][_x10096[28]]);}}});},checkDelivery:function(e){var t=this,a=t[_x10096[19]][_x10096[40]];a[_x10096[16]]=e,t[_x10096[19]][_x10096[17]]?a[_x10096[6]]=t[_x10096[19]][_x10096[17]]:_x10096[2],$[_x10096[41]]({url:app[_x10096[45]][_x10096[44]][_x10096[43]][_x10096[60]],data:a,success:function(a,i,s,r){200==i&&(1==a[_x10096[61]]?$[_x10096[62]](_x10096[63]):(t[_x10096[3]]({submitinfo:a}),t[_x10096[3]]({can_delivery:a[_x10096[64]],show_oos:a[_x10096[65]],delivery_item_none_row:a[_x10096[34]][_x10096[66]]}),t[_x10096[20]](_x10096[16],e)));}});},useVoucher:function(e){var t=this,a={user_voucher_id:e,store_id:t[_x10096[19]][_x10096[27]],voucher_type:_x10096[67]};t[_x10096[19]][_x10096[17]]?a[_x10096[6]]=t[_x10096[19]][_x10096[17]]:_x10096[2],$[_x10096[41]]({url:app[_x10096[45]][_x10096[44]][_x10096[69]][_x10096[68]],data:a,success:function(e,a,i,s){if(200==a){var r=t[_x10096[19]][_x10096[32]];r[_x10096[70]]=e[_x10096[34]][0][_x10096[37]],r[_x10096[28]]=e[_x10096[34]][0][_x10096[28]];var d=r[_x10096[70]]?r[_x10096[70]]:0,o=r[_x10096[39]]?r[_x10096[39]]:0,n=r[_x10096[71]]?r[_x10096[71]]:0,u=r[_x10096[72]]?r[_x10096[72]]:0;r[_x10096[33]]=o+n-d-u,t[_x10096[3]]({submitinfo:r}),t[_x10096[20]](_x10096[28],e[_x10096[34]][0][_x10096[28]]);}}});},count:function(e){this[_x10096[3]]({integral:e[_x10096[14]][_x10096[13]]}),0==e[_x10096[14]][_x10096[13]]&&this[_x10096[3]]({integral:_x10096[2]}),parseInt(e[_x10096[14]][_x10096[13]])>parseInt(this[_x10096[19]][_x10096[32]][_x10096[74]][_x10096[73]])?(this[_x10096[3]]({integral:_x10096[2],discount:0,disbursements:this[_x10096[19]][_x10096[32]][_x10096[76]][_x10096[75]]}),wx[_x10096[77]]({title:_x10096[78],content:_x10096[79]})):this[_x10096[3]]({discount:(this[_x10096[19]][_x10096[81]]/this[_x10096[19]][_x10096[32]][_x10096[74]][_x10096[82]])[_x10096[80]](2),disbursements:(this[_x10096[19]][_x10096[32]][_x10096[76]][_x10096[75]]-this[_x10096[19]][_x10096[81]]/this[_x10096[19]][_x10096[32]][_x10096[74]][_x10096[82]])[_x10096[80]](2)}),this[_x10096[19]][_x10096[83]]<0&&this[_x10096[3]]({disbursements:0}),(this[_x10096[19]][_x10096[81]]/this[_x10096[19]][_x10096[32]][_x10096[74]][_x10096[82]])[_x10096[80]](2)>this[_x10096[19]][_x10096[32]][_x10096[76]][_x10096[75]]&&this[_x10096[3]]({discount:this[_x10096[19]][_x10096[32]][_x10096[76]][_x10096[75]]}),this[_x10096[19]][_x10096[32]][_x10096[76]][_x10096[84]]>=this[_x10096[19]][_x10096[83]]?this[_x10096[3]]({balance:this[_x10096[19]][_x10096[83]],realMoney:0}):this[_x10096[3]]({balance:this[_x10096[19]][_x10096[32]][_x10096[76]][_x10096[84]],realMoney:(this[_x10096[19]][_x10096[83]]-this[_x10096[19]][_x10096[32]][_x10096[76]][_x10096[84]])[_x10096[80]](2)});},getLocalTime:function(e){e=e[_x10096[85]](_x10096[86],_x10096[2])[_x10096[85]](_x10096[87],_x10096[2]);var t=new Date(parseInt(e));return t;},submitorder:function(e){var t=this;if($[_x10096[51]](t[_x10096[19]][_x10096[88]])){var a=t[_x10096[19]][_x10096[40]];if(0==this[_x10096[19]][_x10096[16]])return void wx[_x10096[77]]({title:_x10096[89],showCancel:!1,content:_x10096[90]});if(this[_x10096[19]][_x10096[91]]){var i=this[_x10096[19]][_x10096[92]]+_x10096[93]+this[_x10096[19]][_x10096[94]],s=i[_x10096[85]](/-/g,_x10096[95]),r=new Date(),d=new Date(s),o=r[_x10096[96]](),n=d[_x10096[96]]();if(n-o<0)return void wx[_x10096[77]]({title:_x10096[97],showCancel:!1,content:_x10096[98]});if(this[_x10096[19]][_x10096[56]]&&($[_x10096[51]](this[_x10096[19]][_x10096[92]])||$[_x10096[51]](this[_x10096[19]][_x10096[94]])))return void wx[_x10096[77]]({title:_x10096[99],showCancel:!1,content:_x10096[100]});}a[_x10096[25]]=t[_x10096[19]][_x10096[25]],a[_x10096[16]]=a[_x10096[16]],a[_x10096[5]]=t[_x10096[19]][_x10096[5]],a[_x10096[6]]=t[_x10096[19]][_x10096[6]],a[_x10096[101]]=1,a[_x10096[102]]=10,a[_x10096[103]]=1,a[_x10096[104]]=1,a[_x10096[105]]=_x10096[2],a[_x10096[106]]=t[_x10096[19]][_x10096[106]],a[_x10096[107]]=t[_x10096[19]][_x10096[92]],a[_x10096[108]]=t[_x10096[19]][_x10096[92]]+_x10096[93]+t[_x10096[19]][_x10096[94]],a[_x10096[22]]=t[_x10096[19]][_x10096[22]],$[_x10096[41]]({url:app[_x10096[45]][_x10096[44]][_x10096[69]][_x10096[109]],data:a,success:function(e,a,i,s){200==a?(t[_x10096[3]]({order_id:e[_x10096[88]][_x10096[110]](_x10096[111])}),t[_x10096[112]](),wx[_x10096[113]]({title:_x10096[114]})):wx[_x10096[113]]({title:i});},fail:function(e,t,a,i){wx[_x10096[113]]({title:a});}});}else t[_x10096[112]]();},gotopay:function(e){var t={order_id:this[_x10096[19]][_x10096[88]],openid:app[_x10096[117]][_x10096[116]][_x10096[115]],typ:_x10096[118],payment_channel_code:_x10096[119],prepay_flag:1},a=this;this[_x10096[19]][_x10096[120]]=!0,$[_x10096[41]]({url:app[_x10096[45]][_x10096[44]][_x10096[121]][_x10096[121]],data:t,success:function(e,i,s,r){200==i?wx[_x10096[122]]({timeStamp:e[_x10096[123]],nonceStr:e[_x10096[124]],'package':e[_x10096[125]],signType:e[_x10096[126]],paySign:e[_x10096[127]],success:function(e){a[_x10096[19]][_x10096[128]]&&a[_x10096[129]](t[_x10096[88]],2),a[_x10096[130]](t[_x10096[88]]);},fail:function(e){$[_x10096[131]](_x10096[132]+t[_x10096[88]]),a[_x10096[19]][_x10096[128]]&&a[_x10096[129]](t[_x10096[88]],1);},complete:function(e){_x10096[133]==e[_x10096[134]]&&($[_x10096[131]](_x10096[132]+t[_x10096[88]]),a[_x10096[19]][_x10096[128]]&&a[_x10096[129]](t[_x10096[88]],1));}}):$[_x10096[62]](s);},fail:function(e){}});},inputRemark:function(e){var t=this[_x10096[19]][_x10096[32]];t[_x10096[34]][e[_x10096[138]][_x10096[137]][_x10096[136]]][_x10096[135]]=e[_x10096[14]][_x10096[13]],t[_x10096[34]][e[_x10096[138]][_x10096[137]][_x10096[136]]][_x10096[139]]=e[_x10096[14]][_x10096[13]][_x10096[26]],this[_x10096[19]][_x10096[106]][e[_x10096[138]][_x10096[137]][_x10096[27]]]=e[_x10096[14]][_x10096[13]],this[_x10096[3]]({submitinfo:t});},sendMessage:function(e,t){var a={api:1==t?orderapi[_x10096[140]]:orderapi[_x10096[141]],pages:_x10096[142]+e,formId:this[_x10096[19]][_x10096[143]],WeiXinOpenId:app[_x10096[117]][_x10096[116]][_x10096[115]],value:{order_id:e}};$[_x10096[144]](a);},suitcouponlist:function(e){var t=this,a=t[_x10096[19]][_x10096[40]];a[_x10096[28]]=e[_x10096[138]][_x10096[137]][_x10096[28]],a[_x10096[24]]=JSON[_x10096[145]](t[_x10096[19]][_x10096[32]][_x10096[34]][e[_x10096[138]][_x10096[137]][_x10096[136]]][_x10096[35]]);var i=$[_x10096[146]](_x10096[147],a);wx[_x10096[148]]({url:i});},returnUrl:function(e){var t=this;if(!$[_x10096[51]](t[_x10096[19]][_x10096[149]])){var a=JSON[_x10096[150]](t[_x10096[19]][_x10096[149]]);return 2==a[_x10096[151]]?a[_x10096[152]]?void $[_x10096[131]](_x10096[153]+e):void $[_x10096[154]](1,function(){notice[_x10096[155]](_x10096[156]);}):void $[_x10096[131]](_x10096[132]+e);}$[_x10096[131]](_x10096[132]+e);},selectAddress:function(){var e=this,t=e[_x10096[19]][_x10096[40]],a=_x10096[2];wx[_x10096[157]]({success:function(i){var s={ud_city:i[_x10096[158]],ud_county:i[_x10096[159]],ud_province:i[_x10096[160]],ud_address:i[_x10096[161]],errMsg:i[_x10096[134]],ud_name:i[_x10096[162]],nationalCode:i[_x10096[163]],ud_postalcode:i[_x10096[164]],ud_mobile:i[_x10096[165]],user_id:app[_x10096[117]][_x10096[116]][_x10096[166]]};$[_x10096[41]]({url:app[_x10096[45]][_x10096[44]][_x10096[69]][_x10096[167]],data:s,success:function(i,s,r,d){200==s?(i[_x10096[16]]>0&&(e[_x10096[3]]({ud_id:i[_x10096[16]]}),a=_x10096[168],t[_x10096[169]]=_x10096[170],t[_x10096[16]]=i[_x10096[16]]),wx[_x10096[148]]({url:$[_x10096[146]](a,t)})):$[_x10096[62]](r);}});},fail:function(i){e[_x10096[19]][_x10096[16]]>0?(a=_x10096[168],t[_x10096[169]]=_x10096[170],t[_x10096[16]]=e[_x10096[19]][_x10096[16]]):(a=_x10096[171],t[_x10096[16]]=-1,t[_x10096[169]]=_x10096[170]),wx[_x10096[148]]({url:$[_x10096[146]](a,t)});}});},getNearbylist:function(e){var t=this,a={store_id:e,item_id:this[_x10096[19]][_x10096[172]],lat:this[_x10096[19]][_x10096[173]],lng:this[_x10096[19]][_x10096[174]],page:1,rows:10};$[_x10096[41]]({url:app[_x10096[45]][_x10096[44]][_x10096[176]][_x10096[175]],data:a,dataType:_x10096[118],success:function(e,i,s,r){!$[_x10096[51]](e[_x10096[34]])&&e[_x10096[34]][_x10096[26]]>0&&t[_x10096[3]]({ChainInfo:e[_x10096[34]][0],chain_id:e[_x10096[34]][0][_x10096[22]],AddressInfo:e[_x10096[34]][0],item_id:a[_x10096[54]],physicalStoreId:e[_x10096[34]][0][_x10096[177]]});}});},express:function(){this[_x10096[3]]({addressFlag:!0,selfpickFlag:!1,ud_name:_x10096[2],phone:_x10096[2]}),this[_x10096[19]][_x10096[178]]?this[_x10096[3]]({shipMethod:0}):this[_x10096[3]]({shipMethod:1}),this[_x10096[11]]();},draw:function(e){var t=this;wx[_x10096[179]]({type:_x10096[180],success:function(a){t[_x10096[3]]({latitude:a[_x10096[173]],longitude:a[_x10096[174]]}),t[_x10096[181]](e);},fail:function(){t[_x10096[3]]({isdata:!0}),$[_x10096[62]](_x10096[182]),t[_x10096[181]](e);}}),this[_x10096[19]][_x10096[183]]?this[_x10096[3]]({shipMethod:1}):this[_x10096[3]]({shipMethod:0});},bindTimeChange:function(e){this[_x10096[3]]({time:e[_x10096[14]][_x10096[13]]});},bindDateChange:function(e){this[_x10096[3]]({date:e[_x10096[14]][_x10096[13]]});},switchChange:function(e){e[_x10096[14]][_x10096[13]]?this[_x10096[3]]({realMoney:this[_x10096[19]][_x10096[184]],isBalance:!0}):this[_x10096[3]]({disbursements:this[_x10096[19]][_x10096[83]],isBalance:!1});},editUrlArgs:function(e,t){var a=this[_x10096[19]][_x10096[40]];a[e]=t,this[_x10096[3]]({urlArgs:a});}});}.call(this,['../../helpers/util.js','../../helpers/notice.js','','setData','activity_id','ifcart','cart_id','addNotification','RefreshOrder','RefreshOrderChain','RefreshCoupon','getCartList','removeNotification','value','detail','test','ud_id','spid','addInfo','data','editUrlArgs','ChainInfo','chain_id','parseJSON','val','user_voucher_ids','length','store_id','user_voucher_id','inArray','push','arrayRemove','submitinfo','orderSelMoneyAmount','items','voucher_items','voucher_use_row','voucher_price','store_amount','order_money_select_items','urlArgs','request','checkout','cart','URL','Config','setDate','getDate','getFullYear','-','getMonth','isNull','delivery_address_row','if_virtual','item_id','draw','product_service_date_flag','product_service_contactor_flag','product_valid_type','useVoucher','checkDelivery','need_edit','alert','\u8be5\u6536\u8d27\u5730\u5740\u4e0d\u5b8c\u6574\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9\uff01','can_delivery','show_oos','delivery_item_none_row','voucher','voucher_used','user','total_voucher_price','freight','activityDiscountMoney','UsablePoint','UserMembership','ActualPayPrice','ShoppingCartHeaderInfo','showModal','\u63d0\u793a','\u8bf7\u8f93\u5165\u6b63\u786e\u79ef\u5206\u989d\u5ea6','toFixed','integral','PointAsCashRate','disbursements','MaxUsableCash','replace','/Date(',')/','order_id','\u63d0\u793a','\u8bf7\u9009\u62e9\u4f60\u7684\u6536\u8d27\u5730\u5740\uff01','isVirtual','date',' ','time','/','getTime','\u63d0\u793a','\u60a8\u9009\u62e9\u7684\u9884\u7ea6\u65f6\u95f4\u5df2\u4e0d\u5728\u670d\u52a1\u9884\u7ea6\u65f6\u95f4\u8303\u56f4\u5185!','\u63d0\u793a','\u8bf7\u9009\u62e9\u9884\u7ea6\u670d\u52a1\u65e5\u671f\u4e0e\u65f6\u95f4!','payment_type_id','delivery_type_id','delivery_time_id','invoice_type_id','order_invoice_title','order_message','virtual_service_date','virtual_service_time','order_add','join',',','gotopay','showToast','\u6dfb\u52a0\u8ba2\u5355\u6210\u529f\uff01','openId','userInfo','globalData','json','wx_native','isSubmit','pay','requestPayment','timeStamp','nonceStr','package','signType','paySign','isTmplMsg','sendMessage','returnUrl','redirectTo','../orderdetail/orderdetail?on=','requestPayment:cancel','errMsg','remark','id','dataset','currentTarget','remarkLength','OrderSubmitMessage','OrderPaySuccessWXMessage','pages/orderdetail/orderdetail?on=','formId','sendTpl','stringify','createUrl','../suitcouponlist/suitcouponlist','navigateTo','spinfo','parse','isFightGroup','isOwner','../fightgroupsdetail/fightgroupsdetail?on=','navigateBack','postNotificationName','RefreshFG','chooseAddress','cityName','countyName','provinceName','detailInfo','userName','nationalCode','postalCode','telNumber','user_id','check_wechat_address','../addresslist/addresslist','issub','true','../addressmanage/addressmanage','item_ids','latitude','longitude','getNearChain','store','Id','addressFlag','getLocation','wgs84','getNearbylist','\u6388\u6743\u5931\u8d25','selfpickFlag','realMoney']));