(function(_x30887){'use strict';var app=getApp(),$=require(_x30887[0]),notice=require(_x30887[1]),WxParse=require(_x30887[2]);Page({data:{money:_x30887[3],nodiscount:_x30887[3],discount:_x30887[3],isshow:!1,isshow1:!1,price:_x30887[3],totalMoney:_x30887[3],payment:0,info:[],order_id:_x30887[3],formId:_x30887[3],time:_x30887[3],Description:_x30887[3],MoneyLimit:_x30887[3],CouponEnabeld:_x30887[3],discountvalue:_x30887[3],nodiscountvalue:_x30887[3],DiscountMoney:_x30887[4],couponItemId:0,IsUseCoupon:1,MaxUsableCash:0,MaxUsableECardCash:0,MaxUsableExtraCash:0,balance:0,realMoney:0,isBalance:!0,eCardCash:0,extraCash:0,realPayMoney:0,isECashCard:!0,isCoupon:!0},onLoad:function(a){var t={store_id:app[_x30887[7]][_x30887[6]][_x30887[5]],category:_x30887[8]},e={store_id:app[_x30887[7]][_x30887[6]][_x30887[5]],category:_x30887[9]},o={store_id:app[_x30887[7]][_x30887[6]][_x30887[5]],category:_x30887[10]},s=this;$[_x30887[11]]($[_x30887[12]](orderapi[_x30887[13]],t),function(a){s[_x30887[14]]({price:a[_x30887[15]]}),10==a[_x30887[15]]?s[_x30887[14]]({isshow1:!1}):s[_x30887[14]]({isshow1:!0}),s[_x30887[16]]();}),$[_x30887[11]]($[_x30887[12]](orderapi[_x30887[13]],e),function(a){s[_x30887[14]]({Description:a[_x30887[15]]}),s[_x30887[16]]();}),$[_x30887[11]]($[_x30887[12]](orderapi[_x30887[13]],o),function(a){s[_x30887[14]]({CouponEnabeld:a[_x30887[15]]}),s[_x30887[16]]();}),notice[_x30887[17]](_x30887[18],s[_x30887[18]],s);var i=app[_x30887[7]][_x30887[6]][_x30887[19]];i[_x30887[20]](_x30887[21])>-1?(this[_x30887[14]]({isECashCard:!0}),this[_x30887[22]]()):this[_x30887[14]]({isECashCard:!1}),i[_x30887[20]](_x30887[23])>-1?this[_x30887[14]]({isCoupon:!0}):this[_x30887[14]]({isCoupon:!1});},onUnload:function(){var a=this;notice[_x30887[24]](_x30887[18],a);},GetUserUsableECash:function(){var a={userName:app[_x30887[7]][_x30887[26]][_x30887[25]],orderRealTotal:0},t=this;$[_x30887[11]]($[_x30887[12]](orderapi[_x30887[22]],a),function(a){console[_x30887[27]](a),t[_x30887[14]]({MaxUsableCash:a[_x30887[15]][0][_x30887[28]],MaxUsableECardCash:a[_x30887[15]][0][_x30887[29]],MaxUsableExtraCash:a[_x30887[15]][0][_x30887[30]]});});},RefreshCoupon1:function(a){this[_x30887[14]]({couponItemId:a[_x30887[31]],IsUseCoupon:a[_x30887[32]],DiscountMoney:a[_x30887[33]],MoneyLimit:a[_x30887[34]]}),this[_x30887[16]]();},inputnum:function(a){this[_x30887[14]]({money:a[_x30887[36]][_x30887[35]]}),parseFloat(a[_x30887[36]][_x30887[35]])-(parseFloat(a[_x30887[36]][_x30887[35]])-parseFloat(this[_x30887[38]][_x30887[37]]||0))*(1-this[_x30887[38]][_x30887[39]]/10)<parseFloat(this[_x30887[38]][_x30887[34]])&&this[_x30887[14]]({couponItemId:0,IsUseCoupon:0,DiscountMoney:0,MoneyLimit:0}),$[_x30887[40]](a[_x30887[36]][_x30887[35]])&&this[_x30887[14]]({couponItemId:0,IsUseCoupon:0,DiscountMoney:0,MoneyLimit:0}),parseFloat(this[_x30887[38]][_x30887[37]])>parseFloat(a[_x30887[36]][_x30887[35]])&&(wx[_x30887[41]]({title:_x30887[42],content:_x30887[43]}),this[_x30887[14]]({nodiscount:0,discount:0})),this[_x30887[16]]();},nodiscount:function(a){this[_x30887[14]]({nodiscount:a[_x30887[36]][_x30887[35]]}),parseFloat(this[_x30887[38]][_x30887[44]])-(parseFloat(this[_x30887[38]][_x30887[44]])-parseFloat(a[_x30887[36]][_x30887[35]]||0))*(1-this[_x30887[38]][_x30887[39]]/10)<parseFloat(this[_x30887[38]][_x30887[34]])&&this[_x30887[14]]({couponItemId:0,IsUseCoupon:0,DiscountMoney:0,MoneyLimit:0}),parseFloat(a[_x30887[36]][_x30887[35]])>parseFloat(this[_x30887[38]][_x30887[44]])&&(wx[_x30887[41]]({title:_x30887[45],content:_x30887[46]}),this[_x30887[14]]({nodiscount:0,discount:0,nodiscountvalue:_x30887[3]})),this[_x30887[16]]();},blur:function(a){/^\d{1,10}(\.\d{1,2})?$/[_x30887[47]](a[_x30887[36]][_x30887[35]])||wx[_x30887[41]]({title:_x30887[48],content:_x30887[49]});},blur1:function(a){/^\d{1,10}(\.\d{1,2})?$/[_x30887[47]](a[_x30887[36]][_x30887[35]])||wx[_x30887[41]]({title:_x30887[50],content:_x30887[51]});},inputVal:function(){var a={money:this[_x30887[38]][_x30887[44]],nodiscount:this[_x30887[38]][_x30887[37]],price:this[_x30887[38]][_x30887[39]],discountmoney:this[_x30887[38]][_x30887[33]]};this[_x30887[14]]({discount:((a[_x30887[44]]-a[_x30887[37]])*(1-a[_x30887[39]]/10))[_x30887[52]](2),payment:(a[_x30887[44]]-(a[_x30887[44]]-a[_x30887[37]])*(1-a[_x30887[39]]/10)-a[_x30887[53]])[_x30887[52]](2)}),this[_x30887[38]][_x30887[54]]<0&&this[_x30887[14]]({payment:0}),isNaN(this[_x30887[38]][_x30887[55]])&&this[_x30887[14]]({discount:0}),isNaN(this[_x30887[38]][_x30887[54]])&&this[_x30887[14]]({payment:0}),0==this[_x30887[38]][_x30887[28]]&&this[_x30887[14]]({realPayMoney:this[_x30887[38]][_x30887[54]]}),this[_x30887[38]][_x30887[28]]>=this[_x30887[38]][_x30887[54]]?this[_x30887[14]]({balance:this[_x30887[38]][_x30887[54]],realMoney:0}):this[_x30887[14]]({balance:this[_x30887[38]][_x30887[28]],realMoney:(this[_x30887[38]][_x30887[54]]-this[_x30887[38]][_x30887[28]])[_x30887[52]](2)}),this[_x30887[14]]({realPayMoney:this[_x30887[38]][_x30887[56]]}),0==this[_x30887[38]][_x30887[57]]&&this[_x30887[14]]({realPayMoney:this[_x30887[38]][_x30887[54]]});},suitcouponlist:function(){var a={money:this[_x30887[38]][_x30887[44]],nodiscount:this[_x30887[38]][_x30887[37]],price:this[_x30887[38]][_x30887[39]]};this[_x30887[14]]({discount:((a[_x30887[44]]-a[_x30887[37]])*(1-a[_x30887[39]]/10))[_x30887[52]](2)});var t={userId:app[_x30887[7]][_x30887[26]][_x30887[58]],store_id:app[_x30887[7]][_x30887[6]][_x30887[5]],realMoney:(a[_x30887[44]]-(a[_x30887[44]]-a[_x30887[37]])*(1-a[_x30887[39]]/10))[_x30887[52]](2)},e=this;$[_x30887[11]]($[_x30887[12]](cartapi[_x30887[59]],t),function(a){e[_x30887[14]]({info:a[_x30887[15]]}),wx[_x30887[60]]({url:_x30887[61]+JSON[_x30887[62]](a[_x30887[15]])+_x30887[63]+e[_x30887[38]][_x30887[31]]});});},checkboxChange:function(a){console[_x30887[27]](a[_x30887[36]][_x30887[35]][_x30887[64]]),a[_x30887[36]][_x30887[35]][_x30887[64]]>0?this[_x30887[14]]({isshow:!0}):this[_x30887[14]]({isshow:!1,nodiscount:0}),this[_x30887[16]]();},paysubmit:function(a){var t=this;if($[_x30887[40]](this[_x30887[38]][_x30887[44]])||0==this[_x30887[38]][_x30887[44]])return wx[_x30887[41]]({title:_x30887[65],content:_x30887[66]}),!1;if(!/^\d{1,10}(\.\d{1,2})?$/[_x30887[47]](t[_x30887[38]][_x30887[44]]))return wx[_x30887[41]]({title:_x30887[67],content:_x30887[68]}),!1;if(t[_x30887[38]][_x30887[69]]&&!/^\d{1,10}(\.\d{1,2})?$/[_x30887[47]](t[_x30887[38]][_x30887[37]]))return wx[_x30887[41]]({title:_x30887[70],content:_x30887[71]}),!1;if(parseFloat(t[_x30887[38]][_x30887[37]])>parseFloat(t[_x30887[38]][_x30887[44]]))return wx[_x30887[41]]({title:_x30887[72],content:_x30887[73]}),!1;this[_x30887[38]][_x30887[57]]?(0==this[_x30887[38]][_x30887[28]]&&this[_x30887[14]]({eCardCash:(1*this[_x30887[38]][_x30887[29]])[_x30887[52]](2),extraCash:(1*this[_x30887[38]][_x30887[30]])[_x30887[52]](2)}),0!=this[_x30887[38]][_x30887[28]]&&0==this[_x30887[38]][_x30887[74]]&&this[_x30887[14]]({eCardCash:(1*this[_x30887[38]][_x30887[29]])[_x30887[52]](2),extraCash:(1*this[_x30887[38]][_x30887[30]])[_x30887[52]](2)}),this[_x30887[38]][_x30887[74]]>=this[_x30887[38]][_x30887[29]]&&this[_x30887[14]]({eCardCash:(1*this[_x30887[38]][_x30887[29]])[_x30887[52]](2),extraCash:(this[_x30887[38]][_x30887[74]]-1*this[_x30887[38]][_x30887[29]])[_x30887[52]](2)}),this[_x30887[38]][_x30887[74]]<this[_x30887[38]][_x30887[29]]&&this[_x30887[14]]({eCardCash:(1*this[_x30887[38]][_x30887[74]])[_x30887[52]](2),extraCash:0})):this[_x30887[14]]({eCardCash:0,extraCash:0});var e={userName:app[_x30887[7]][_x30887[26]][_x30887[25]],payTypeId:9,couponItemId:this[_x30887[38]][_x30887[31]],store_id:app[_x30887[7]][_x30887[6]][_x30887[5]],totalMoney:this[_x30887[38]][_x30887[44]],preferential:this[_x30887[38]][_x30887[39]],preferentialMoney:this[_x30887[38]][_x30887[55]],nonPreferentialMoney:this[_x30887[38]][_x30887[37]]||0,realMoney:this[_x30887[38]][_x30887[75]],firstType:2,eCardCash:this[_x30887[38]][_x30887[76]],extraCash:this[_x30887[38]][_x30887[77]]};console[_x30887[27]](e),$[_x30887[11]]($[_x30887[12]](orderapi[_x30887[78]],e),function(a){console[_x30887[27]](a),t[_x30887[14]]({order_id:a[_x30887[15]][_x30887[79]]}),0==a[_x30887[80]]&&(a[_x30887[15]][_x30887[81]]>0?t[_x30887[82]]():0==a[_x30887[15]][_x30887[81]]&&$[_x30887[83]](_x30887[84]+a[_x30887[15]][_x30887[79]]));});},gotopay:function(){var a=this,t={order_id:this[_x30887[38]][_x30887[79]],openid:app[_x30887[7]][_x30887[26]][_x30887[85]],store_id:app[_x30887[7]][_x30887[6]][_x30887[5]],typ:_x30887[86],payment_channel_code:_x30887[87],prepay_flag:1};$[_x30887[88]]({url:app[_x30887[91]][_x30887[90]][_x30887[89]][_x30887[89]],data:t,success:function(e,o,s,i){200==o?wx[_x30887[92]]({timeStamp:e[_x30887[93]],nonceStr:e[_x30887[94]],'package':e[_x30887[95]],signType:e[_x30887[96]],paySign:e[_x30887[97]],success:function(e){a[_x30887[98]](t[_x30887[79]]);},fail:function(a){$[_x30887[83]](_x30887[84]+t[_x30887[79]]);},complete:function(e){_x30887[99]==e[_x30887[100]]&&($[_x30887[83]](_x30887[84]+t[_x30887[79]]),a[_x30887[101]](t[_x30887[79]],1));}}):$[_x30887[102]](s);},fail:function(a){}});},returnUrl:function(a){var t=this;if(!$[_x30887[40]](t[_x30887[38]][_x30887[103]])){var e=JSON[_x30887[104]](t[_x30887[38]][_x30887[103]]);return 2==e[_x30887[105]]?e[_x30887[106]]?void $[_x30887[83]](_x30887[107]+a):void $[_x30887[108]](1,function(){notice[_x30887[109]](_x30887[110]);}):void $[_x30887[83]](_x30887[84]+a);}$[_x30887[83]](_x30887[84]+a);},switchChange:function(a){console[_x30887[27]](a),a[_x30887[36]][_x30887[35]]?this[_x30887[14]]({realPayMoney:this[_x30887[38]][_x30887[56]],isBalance:!0}):this[_x30887[14]]({realPayMoney:this[_x30887[38]][_x30887[54]],isBalance:!1});}});}.call(this,['../../helpers/util.js','../../helpers/notice.js','../../wxParse/wxParse.js','','0.00','store_id','shopInfo','globalData','QuickPay.Discount','QuickPay.Description','QuickPay.CouponEnabeld','xsr','makeUrl','GetVendorSetting','setData','Info','inputVal','addNotification','RefreshCoupon1','VendorFeatureSet','indexOf','ECashCard','GetUserUsableECash','Coupon','removeNotification','user_account','userInfo','log','MaxUsableCash','MaxUsableECardCash','MaxUsableExtraCash','couponItemId','IsUseCoupon','DiscountMoney','MoneyLimit','value','detail','nodiscount','data','price','isNull','showModal','\u63d0\u793a','\u4e0d\u53c2\u4e0e\u4f18\u60e0\u91d1\u989d\u5e94\u5c0f\u4e8e\u603b\u91d1\u989d','money','\u63d0\u793a','\u4e0d\u53c2\u4e0e\u4f18\u60e0\u91d1\u989d\u5e94\u5c0f\u4e8e\u603b\u91d1\u989d','test','\u63d0\u793a','\u8bf7\u8f93\u5165\u6b63\u786e\u91d1\u989d','\u63d0\u793a','\u8bf7\u8f93\u5165\u6b63\u786e\u91d1\u989d','toFixed','discountmoney','payment','discount','realMoney','isBalance','user_id','GetUsableCouponItemListForQuickPay','navigateTo','../favorablesuitcouponlist/favorablesuitcouponlist?val=','stringify','&id=','length','\u63d0\u793a','\u8bf7\u8f93\u5165\u6d88\u8d39\u603b\u91d1\u989d','\u63d0\u793a','\u8bf7\u8f93\u5165\u6b63\u786e\u91d1\u989d','isshow','\u63d0\u793a','\u8bf7\u8f93\u5165\u6b63\u786e\u91d1\u989d','\u63d0\u793a','\u4e0d\u53c2\u4e0e\u4f18\u60e0\u91d1\u989d\u5e94\u5c0f\u4e8e\u603b\u91d1\u989d','balance','realPayMoney','eCardCash','extraCash','AddPreferentialOrder','order_id','Code','RealTotal','gotopay','redirectTo','../favorableorderdetail/favorableorderdetail?on=','openId','json','wx_native','request','pay','URL','Config','requestPayment','timeStamp','nonceStr','package','signType','paySign','returnUrl','requestPayment:cancel','errMsg','sendMessage','alert','spinfo','parse','isFightGroup','isOwner','../fightgroupsdetail/fightgroupsdetail?on=','navigateBack','postNotificationName','RefreshFG']));